<%
=begin
This file is part of SSID.

SSID is free software: you can redistribute it and/or modify
it under the terms of the GNU Lesser General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

SSID is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU Lesser General Public License for more details.

You should have received a copy of the GNU Lesser General Public License
along with SSID.  If not, see <http://www.gnu.org/licenses/>.
=end
%>


<script type="text/javascript">
  function filter() {
    var selectBox = document.getElementById('sltSimSource');
    var array = new Array();
    while (selectBox.length > 0) {
      if (selectBox.options[0].selected) {
        array[selectBox.options[0].value] = true;
      }
      selectBox.options[0] = null;
    }

    var selectedStudentArray = new Array();

    var selectedBox = document.getElementById('sltSimTarget');
    for (i = 0; i < selectedBox.length; i++) {
      selectedStudentArray[selectedBox.options[i].value] = true;
    }

    var text = document.getElementById('txtfilter').value;
    var optn;

    for (i = 0; i < allCoders.length; i++) {
      if (allCoders[i].indexOf(text) >= 0 && selectedStudentArray[allCoders[i]] != true) {
        optn = document.createElement("OPTION");
        optn.text = allCoders[i];
        optn.value = allCoders[i];
        selectBox.options.add(optn);
        if (array[allCoders[i]] == true) {
          optn.selected = true;
        }
      }
    }

    if (selectBox.length == 1) {
      selectBox.selectedIndex = 0;
    }
  }

  function validate() {
    var selectBox = document.getElementById('sltSimTarget');

    if (selectBox.length < 2) {
      alert('Please select at least two students');
      return false;
    }

    return true;
  }
</script>

  <h3 style="display:inline">This graph provides an overview of code similarities between 2 or more students for all assignments</h3>
  <p/>
  To add student(s), select the student(s) from <b>Available Students</b> and click <b>Add</b><br/>
  To remove student(s), select the student(s) from <b>Selected Students</b> and click <b>Remove</b>
  <p/>
<form id="frmSim" action="graph_sims" onsubmit="submitProgrammers();">
  <table style="width: auto;">
    <tr>
      <td align="left" style="white-space:nowrap;">
        <div style="padding-bottom: 3px; font-weight: bold;">Available Students</div>
        <div style="width:208px; margin-bottom: 5px;">
          <span style="width:60px;">Search : </span>
          <input id="txtfilter" type="text" style="width:147px;" onkeyup="filter();"/>
        </div>
        <select id="sltSimSource" size="10" style="margin-left: 0px; height:173px;width:100%;" multiple>
          <% for i in (0...@allCoders.length) %>
            <option value="<%=@allCoders[i]%>"><%=@allCoders[i]%>&nbsp;&nbsp;</option>
          <% end %>
        </select>
      </td>
      <td valign="center" align="center">
        <input type="button" class="margined" value="Add >>" onclick="addProgrammers();" style="width:90px" />
        <p/>
        <input type="button" class="margined" value="<< Remove" onclick="removeProgrammers();" style="width:90px" />
      </td>
      <td valign="top">
        <div style="padding-bottom: 3px; font-weight: bold;">Selected Students</div>
        <select name="programmers[]" id="sltSimTarget" size="10" style="margin-left: 0px; height:200px;width:200px;" multiple />
      </td>
    </tr>
  </table>
  <input type="hidden" name="courseId" value="<%=@course.id%>"/>
  <hr />
  <input type="submit" value="Show Graph" onclick="if (!validate()) { return false;}" onmouseover="Tip('The graph will be displayed in a new window');" onmouseout="UnTip();" />
  <p/>
  <div class="instruction" style="text-align: left;">Note: The graph will be displayed in a new window</div>
</form>