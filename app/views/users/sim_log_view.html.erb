<%
=begin
This file is part of SSID.

SSID is free software: you can redistribute it and/or modify
it under the terms of the GNU Lesser General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

SSID is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU Lesser General Public License for more details.

You should have received a copy of the GNU Lesser General Public License
along with SSID.  If not, see <http://www.gnu.org/licenses/>.
=end
%>

<%
def genText(logColor, text)
  "<font color='#{logColor}'>#{text}</font>"
end

myLogs = []
for log in @logs
  begin
    myLogs << log if log.assignment_sim_result.assignment.course
  rescue
  end
end

@logs = myLogs
%>
<h2>Student: <%=@student.matric%></h2>
<hr />
<% if @logs.size == 0 %>
  No log is available.
<% else %>
  <table class="listing" border="0" cellspacing="5">
    <col width="1*"/>
    <col width="1*"/>
    <col width="1*"/>
    <col width="1*"/>
    <col width="3*"/>
    <thead>
      <tr class="listing">
        <th class="listing">Date/Time</th>
        <th class="listing">Module</th>
        <th class="listing">Assignment</th>
        <th class="listing">Grader</th>
        <th class="listing">Remarks</th>
      </tr>
    </thead>
    <tbody>
      <% for log in @logs
        begin
          course = log.assignment_sim_result.assignment.course

          logColor = case log.log_type
          when 2, 3 then "red"
          when 0 then "orange"
          else
            "blue"
          end

          logRemark = case log.log_type
          when 0 then
            "Reported submissions from students #{log.assignment_sim_result.code1.student.matric} and #{log.assignment_sim_result.code2.student.matric} as suspicious"
          when 1 then
            "Found innocent for students #{log.assignment_sim_result.code1.student.matric} and #{log.assignment_sim_result.code2.student.matric}"
          when 2 then
            "Confirmed submissions from students #{log.assignment_sim_result.code1.student.matric} and #{log.assignment_sim_result.code2.student.matric} as plagiarism"
          when 3 then
            "The student is found guilty in plagiarism"
          when 4 then
            "The student is found innocent in plagiarism"
          else
            ""
          end

        %>
          <tr class="listing">
            <td class="listing" style="cursor: default;"><%= genText(logColor, log.updated_at.strftime("%d/%m/%Y %H:%M:%S")).html_safe %></td>
            <td class="listing" style="cursor: default;"><%= genText(logColor, course.code).html_safe %></td>
            <td class="listing" style="cursor: default;"><%= genText(logColor, log.assignment_sim_result.assignment.title).html_safe%></td>
            <td class="listing" style="cursor: default;"><%= genText(logColor, log.account.name).html_safe %></td>
            <td class="listing" style="cursor: default;"><%= genText(logColor, logRemark).html_safe%></td>
          </tr>
        <%
        rescue

        end
      end
    %>
    </tbody>
  </table>
<% end %>
<hr/>
<a href="" onclick="history.back(); return false;" class="normalLink">Back</a>

